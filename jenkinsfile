pipeline{
    agent any
    stages{
        stage('dockerhub pull image'){
            steps{
                withCredentials([string(credentialsId: 'my_docker_hub_password', variable: 'DockerHubPwd')]) {
                    sh "docker login -u xgenosama -p ${DockerHubPwd}"
                }
                sh "docker pull  xgenosama/backhouse"
            }
        }
        stage('apply deployment to minikube'){
            steps{
                sh "kubectl  apply -f namespace.yaml"
                sh "kubectl  apply -f deployment.yaml"
                sh "kubectl  apply -f service.yaml"
            }
        }
    }
}